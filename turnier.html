<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Single-Elimination Turnier</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f4f4f4;
        padding: 20px;
    }
    h1, h2 {
        text-align: center;
    }
    .setup {
        text-align: center;
        margin-bottom: 20px;
    }
    input, button {
        padding: 8px;
        margin: 5px;
        font-size: 14px;
    }
    .names {
        text-align: center;
        margin-bottom: 20px;
    }
    .bracket {
        display: flex;
        justify-content: center;
        gap: 40px;
        overflow-x: auto;
    }
    .round {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    .match {
        background: white;
        border: 2px solid #333;
        padding: 10px;
        cursor: pointer;
        text-align: center;
        min-width: 140px;
    }
    .match:hover {
        background: #e0e0e0;
    }
    .winner {
        background: #b6ffb6;
        border-color: green;
        font-weight: bold;
    }
    .bye {
        background: #ddd;
        cursor: default;
    }
    .reset {
        text-align: center;
        margin-top: 30px;
    }
</style>
</head>
<body>

<h1>Single-Elimination Turnier</h1>

<div class="setup">
    <label>Teilnehmeranzahl:</label>
    <input type="number" id="count" min="2">
    <button onclick="createNameInputs()">Weiter</button>
</div>

<div class="names" id="names"></div>

<div class="bracket" id="bracket"></div>

<div class="reset">
    <button onclick="location.reload()">Reset / Neustart</button>
</div>

<script>
let rounds = [];

function createNameInputs() {
    const count = parseInt(document.getElementById("count").value);
    if (!count || count < 2) return;

    const container = document.getElementById("names");
    container.innerHTML = "<h2>Namen eingeben</h2>";

    for (let i = 0; i < count; i++) {
        container.innerHTML += `<input placeholder="Teilnehmer ${i + 1}" id="name${i}"><br>`;
    }
    container.innerHTML += `<br><button onclick="startTournament(${count})">Turnier starten</button>`;
}

function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

function startTournament(count) {
    let players = [];
    for (let i = 0; i < count; i++) {
        const name = document.getElementById(`name${i}`).value || `Spieler ${i + 1}`;
        players.push(name);
    }

    shuffle(players);

    // n√§chste 2er-Potenz
    let size = 1;
    while (size < players.length) size *= 2;

    while (players.length < size) {
        players.push(null); // Bye
    }

    rounds = [];
    rounds.push(players.map(p => ({ name: p, winner: false })));

    drawBracket();
}

function drawBracket() {
    const bracket = document.getElementById("bracket");
    bracket.innerHTML = "";

    for (let r = 0; r < rounds.length; r++) {
        const roundDiv = document.createElement("div");
        roundDiv.className = "round";

        for (let i = 0; i < rounds[r].length; i += 2) {
            const p1 = rounds[r][i];
            const p2 = rounds[r][i + 1];

            const match = document.createElement("div");
            match.className = "match";

            if (p1.name && !p2.name) {
                match.textContent = p1.name + " (Freilos)";
                match.classList.add("bye");
                advance(r, i);
            } else if (!p1.name && p2.name) {
                match.textContent = p2.name + " (Freilos)";
                match.classList.add("bye");
                advance(r, i + 1);
            } else if (!p1.name && !p2.name) {
                match.textContent = "‚Äî";
                match.classList.add("bye");
            } else {
                match.innerHTML = `${p1.name}<br>vs<br>${p2.name}`;
                match.onclick = () => advance(r, i);
            }

            roundDiv.appendChild(match);
        }
        bracket.appendChild(roundDiv);
    }
}

function advance(roundIndex, playerIndex) {
    const player = rounds[roundIndex][playerIndex];
    if (!player || player.winner) return;

    if (!rounds[roundIndex + 1]) {
        rounds[roundIndex + 1] = [];
    }

    player.winner = true;
    rounds[roundIndex + 1].push({ name: player.name, winner: false });

    drawBracket();

    // Sieger anzeigen
    if (rounds[roundIndex + 1].length === 1 && rounds[roundIndex].length === 2) {
        alert("üèÜ Sieger: " + player.name);
    }
}
</script>

</body>
</html>
